# Как вы использовали Node Exporter на практике, для каких команд устанавливали и какие кейсы с ним были?

### **1. Как Node Exporter использовался в вашей работе?**
**Пример ответа:**  
"Node Exporter использовался для сбора метрик с серверов, таких как CPU, память, диски, сетевой трафик и нагрузка системы (load average). Мы интегрировали его с Prometheus для мониторинга состояния серверов и Grafana для визуализации. Это позволяло нам отслеживать производительность серверов в реальном времени, настраивать алерты и анализировать тренды."

---

### **2. Какие команды вы использовали для работы с Node Exporter?**
**Пример ответа:**

- **Установка Node Exporter:**
  ```bash
  wget https://github.com/prometheus/node_exporter/releases/download/v1.6.1/node_exporter-1.6.1.linux-amd64.tar.gz
  tar xvfz node_exporter-1.6.1.linux-amd64.tar.gz
  ./node_exporter --web.listen-address=":9100"
  ```
  "Я устанавливал Node Exporter через скачивание бинарного файла с GitHub. Запускал его с флагом `--web.listen-address`, чтобы указать порт (по умолчанию 9100)."

- **Проверка работы Node Exporter:**
  ```bash
  curl http://localhost:9100/metrics
  ```
  "Для проверки работы я использовал `curl`, чтобы получить метрики из `/metrics`. Это помогало убедиться, что Node Exporter корректно собирает данные."

- **Настройка автозапуска через systemd:**
  ```ini
  [Unit]
  Description=Node Exporter

  [Service]
  ExecStart=/usr/local/bin/node_exporter

  [Install]
  WantedBy=multi-user.target
  ```
  "Для автоматического запуска я создавал unit-файл для systemd, чтобы Node Exporter работал как служба."

---

### **3. Кому вы устанавливали Node Exporter?**
**Пример ответа:**  
"Я устанавливал Node Exporter на:
- **Веб-серверы:** для мониторинга нагрузки и доступности.
- **Базы данных:** для отслеживания использования ресурсов (например, PostgreSQL или MySQL).
- **Контейнеры и виртуальные машины:** для анализа производительности на уровне хоста.
- **Серверы приложений:** для контроля за потреблением CPU, памяти и дискового пространства."

---

### **4. Какие каверзные вопросы могут возникнуть и как на них ответить?**

#### **Вопрос: Как вы решали проблемы с производительностью Node Exporter?**
**Ответ:**  
"Node Exporter сам по себе очень легковесный, но если возникали проблемы с производительностью, я проверял:
- Нагрузку на CPU и память через метрики самого Node Exporter (`process_cpu_seconds_total` и `process_resident_memory_bytes`).
- Корректность настройки коллекционеров (collectors). Например, можно отключить ненужные коллекционеры через флаг `--collector.disable-defaults` и включить только те, которые нужны."

#### **Вопрос: Что делать, если Node Exporter не собирает нужные метрики?**
**Ответ:**  
"Если Node Exporter не собирает определённые метрики, я проверял:
- Доступность файлов `/proc` и `/sys`, так как Node Exporter использует их для сбора данных.
- Настройки прав доступа к этим файлам.
- Включение нужных коллекционеров. Например, для мониторинга RAID нужно включить `textfile` collector и написать скрипт для сбора данных."

#### **Вопрос: Как вы обеспечивали безопасность Node Exporter?**
**Ответ:**  
"Я ограничивал доступ к порту 9100 через firewall (например, с помощью `iptables`) или настраивал reverse proxy (Nginx) с базовой аутентификацией. Также мы размещали Node Exporter только внутри закрытой сети, чтобы минимизировать риски."

#### **Вопрос: Как вы решали проблему с большим количеством метрик?**
**Ответ:**  
"Если метрик было слишком много, я:
- Отключал ненужные коллекционеры через флаг `--no-collector.<name>`.
- Фильтровал метрики в Prometheus, используя `relabel_configs` или `metric_relabel_configs`.
- Использовал агрегацию данных в PromQL для уменьшения объёма информации."

---

### **5. Пример успешного кейса использования Node Exporter**
**Пример ответа:**  
"Однажды мы столкнулись с проблемой высокой загрузки CPU на одном из серверов. С помощью Node Exporter и Prometheus мы настроили мониторинг метрики `node_cpu_seconds_total` и обнаружили, что один процесс потребляет больше 90% CPU. После анализа логов и профилирования процесса мы оптимизировали код приложения, что снизило нагрузку на сервер."

---

### **6. Что ещё можно добавить?**

- **Интеграция с другими инструментами:**  
  "Мы также интегрировали Node Exporter с Alertmanager для отправки уведомлений о критических событиях (например, когда свободное место на диске падает ниже 10%)."

- **Автоматизация установки:**  
  "Для масштабирования я написал Ansible playbook для автоматической установки и настройки Node Exporter на всех серверах."

- **Мониторинг контейнеров:**  
  "Для мониторинга контейнеров мы комбинировали Node Exporter с cAdvisor, чтобы получать более детальную информацию о ресурсах внутри контейнеров."
