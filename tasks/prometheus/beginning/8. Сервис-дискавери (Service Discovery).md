## Сервис-дискавери (Service Discovery)

### Что это:
**Service Discovery** — это механизм, который позволяет автоматически обнаруживать сервисы или таргеты (цели) мониторинга в динамических средах. Это особенно важно в современных облачных и контейнеризированных инфраструктурах, где сервисы могут появляться и исчезать динамически (например, в Kubernetes).

#### Как работает:
Prometheus поддерживает несколько методов Service Discovery, которые позволяют ему автоматически находить и добавлять целевые адреса для сбора метрик. Вот основные типы дискавери:

- **File-based SD**: Prometheus читает список целей из файла, который может быть регулярно обновляемым.
- **DNS-based SD**: Использует DNS записи для обнаружения новых целей.
- **Kubernetes SD**: Интеграция с API Kubernetes для автоматического отслеживания подов, сервисов и других ресурсов.
- **AWS SD**: Обнаружение целей через API AWS (EC2 инстансы, ELB и т.д.).
- **Consul SD**: Интеграция с HashiCorp Consul для обнаружения сервисов.

#### Архитектурные особенности:
- Prometheus периодически запрашивает источник Service Discovery для получения актуального списка таргетов.
- При изменении инфраструктуры (например, создание нового пода в Kubernetes), Prometheus автоматически обновляет свои таргеты без необходимости перезапуска.
- Поддерживается фильтрация таргетов с помощью label'ов.

#### Практическое применение:
- В Kubernetes: автоматическое добавление подов с метками `app=example` для мониторинга.
- В AWS: мониторинг EC2 инстансов, которые соответствуют определенным тегам.
- В локальных сетях: использование DNS для отслеживания серверов.

#### Преимущества:
- Упрощение конфигурации в динамических средах.
- Автоматическая адаптация к изменениям инфраструктуры.
- Снижение вероятности пропуска новых сервисов при масштабировании.
