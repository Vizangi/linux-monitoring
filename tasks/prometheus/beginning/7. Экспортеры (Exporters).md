## Экспортеры (Exporters)
   
В **Prometheus** экспортеры (exporters) — это программы или службы, которые собирают метрики из различных источников и предоставляют их в формате, понятном Prometheus. Экспортеры позволяют интегрировать Prometheus с разнообразными системами, приложениями и сервисами.

   1. **Сбор метрик**:
      - Экспортер собирает данные из целевой системы (например, использование CPU, память, количество запросов к базе данных).
      - Эти данные преобразуются в метрики в формате Prometheus.
   
   2. **Предоставление метрик**:
      - Экспортер предоставляет метрики через HTTP-эндпоинт, обычно в виде простого текстового формата.
      - Пример вывода:
        ```plaintext
        # HELP node_cpu_seconds_total Seconds the CPUs spent in each mode.
        # TYPE node_cpu_seconds_total counter
        node_cpu_seconds_total{cpu="0",mode="user"} 12345.67
        node_cpu_seconds_total{cpu="0",mode="system"} 6789.01
        ```
   
   3. **Сбор метрик Prometheus**:
      - Prometheus периодически запрашивает (вытягивает) метрики с экспортера по HTTP.
      - В конфигурации Prometheus указывается адрес экспортера:
        ```yaml
        scrape_configs:
          - job_name: 'node_exporter'
            static_configs:
              - targets: ['ip_address:9100']
        ```
   
   4. **Анализ и визуализация**:
      - Собранные метрики можно анализировать с помощью PromQL и визуализировать в Grafana.


### **Типы и виды экспортеров**

Экспортеры можно классифицировать по нескольким критериям:

---

### 1. **По способу работы**
#### a) **Push-экспортеры**
   - Эти экспортеры отправляют метрики на Pushgateway (промежуточный компонент Prometheus), который затем скрейпит эти данные.
   - Используются для временных задач, таких как пакетные операции или короткие процессы, которые не могут ждать запроса от Prometheus.
   - Пример: `batch_job_exporter`.

#### b) **Pull-экспортеры**
   - Большинство экспортеров работают по модели "pull", где Prometheus сам запрашивает метрики у экспортера.
   - Это стандартный подход для постоянных служб и процессов.
   - Пример: `node_exporter`, `mysql_exporter`.

---

### 2. **По типу мониторинга**
#### a) **Системные экспортеры**
   - Собирают метрики о состоянии хоста или сервера.
   - Пример:
     - **Node Exporter**: Мониторит ресурсы ОС, такие как CPU, память, дисковое пространство, сетевая активность и т.д.
     - **Blackbox Exporter**: Проверяет доступность удаленных сервисов через HTTP, DNS, TCP и ICMP.

#### b) **Базы данных и хранилища**
   - Собирают метрики о работе баз данных и хранилищ данных.
   - Пример:
     - **MySQL Exporter**: Для мониторинга MySQL.
     - **PostgreSQL Exporter**: Для PostgreSQL.
     - **MongoDB Exporter**: Для MongoDB.
     - **Redis Exporter**: Для Redis.

#### c) **Веб-серверы и приложения**
   - Собирают метрики о работе веб-серверов и приложений.
   - Пример:
     - **Nginx Exporter**: Для Nginx.
     - **Apache Exporter**: Для Apache.
     - **Java Micrometer**: Для Java-приложений.

#### d) **Облачные сервисы**
   - Интегрируются с облачными платформами для сбора метрик.
   - Пример:
     - **AWS Exporter**: Для AWS EC2, RDS и других сервисов.
     - **GCP Exporter**: Для Google Cloud Platform.

#### e) **Промежуточные системы**
   - Работают как мост между Prometheus и другими системами мониторинга.
   - Пример:
     - **StatsD Exporter**: Преобразует метрики StatsD в формат Prometheus.
     - **Graphite Exporter**: Преобразует метрики Graphite.

---

### 3. **По уровню интеграции**
#### a) **Стандартные экспортеры**
   - Это официально поддерживаемые экспортеры, разработанные сообществом Prometheus.
   - Пример: Node Exporter, Blackbox Exporter.

#### b) **Третьесторонние экспортеры**
   - Разработаны сторонними компаниями или сообществами для специфических целей.
   - Пример: MongoDB Exporter, RabbitMQ Exporter.

#### c) **Встроенные экспортеры**
   - Некоторые приложения и системы уже имеют встроенные эндпоинты для экспорта метрик в формате Prometheus.
   - Пример: Kubernetes, Elasticsearch, Kafka.

---

### 4. **По сложности реализации**
#### a) **Готовые экспортеры**
   - Представляют собой готовые программы, которые можно просто установить и настроить.
   - Пример: Node Exporter, MySQL Exporter.

#### b) **Кастомные экспортеры**
   - Создаются специально для определенных задач или систем.
   - Может потребоваться написание собственного кода для экспорта метрик.
   - Пример: Если вы хотите мониторить внутреннюю бизнес-логику вашего приложения.

---

### **Популярные экспортеры**

1. **Node Exporter**
   - Собирает метрики об операционной системе и оборудовании (CPU, память, диск, сеть).
   - URL для скрейпинга: `/metrics`.

2. **Blackbox Exporter**
   - Позволяет проверять доступность сервисов через HTTP, HTTPS, DNS, TCP и ICMP.
   - Полезен для мониторинга внешних зависимостей.

3. **MySQL Exporter**
   - Собирает метрики о состоянии базы данных MySQL/MariaDB.

4. **Nginx Exporter**
   - Собирает метрики о работе веб-сервера Nginx.

5. **Kubernetes Exporter**
   - Собирает метрики о кластере Kubernetes (узлы, поды, деплойменты).

6. **JMX Exporter**
   - Собирает метрики из Java-приложений через JMX.

7. **Pushgateway**
   - Не является классическим экспортером, но используется для приема метрик от временных задач.

---

### **Как выбрать экспортер?**

1. **Определите цель мониторинга**:
   - Что именно вы хотите отслеживать (например, производительность системы, работу базы данных или состояние приложения)?

2. **Выберите подходящий экспортер**:
   - Используйте готовые экспортеры, если они поддерживают вашу систему.
   - Если готового решения нет, рассмотрите возможность создания кастомного экспортера.

3. **Установите и настройте экспортер**:
   - Убедитесь, что экспортер правильно конфигурируется и предоставляет нужные метрики.

---
