# Как вы использовали Сustom Exporter на практике, для каких команд устанавливали и какие кейсы с ним были?

### **1. Как Custom Exporter использовался в вашей работе?**
**Пример ответа:**
"Custom Exporter использовался для сбора метрик, которые не покрывались стандартными инструментами, такими как Node Exporter или Blackbox Exporter. Например, мы писали собственные экспортеры для мониторинга:
- Логов приложений.
- Специфических бизнес-метрик (например, количество заказов в системе).
- Состояния сторонних сервисов, которые не предоставляли готовых метрик.
Эти данные собирались и отправлялись в Prometheus для дальнейшего анализа и визуализации в Grafana."

---

### **2. На каком языке вы писали Custom Exporter?**
**Пример ответа:**
"Я писал Custom Exporter на Python, используя библиотеку `prometheus_client`. Это удобно, потому что Python имеет богатую экосистему для работы с API, базами данных и файлами. Если нужна была высокая производительность, я использовал Go, так как он отлично подходит для создания легковесных и быстрых приложений."

---

### **3. Какие команды вы использовали для работы с Custom Exporter?**
**Пример ответа:**

- **Запуск Custom Exporter на Python:**
  ```bash
  python custom_exporter.py --port=9101
  ```
  "Я запускал Python-скрипт с флагом `--port`, чтобы указать порт для метрик."

- **Проверка работы Custom Exporter:**
  ```bash
  curl http://localhost:9101/metrics
  ```
  "Для проверки работы я использовал `curl`, чтобы получить метрики из `/metrics`."

- **Настройка автозапуска через systemd:**
  ```ini
  [Unit]
  Description=Custom Exporter

  [Service]
  ExecStart=/usr/bin/python3 /path/to/custom_exporter.py --port=9101

  [Install]
  WantedBy=multi-user.target
  ```
  "Для автоматического запуска я создавал unit-файл для systemd, чтобы Custom Exporter работал как служба."

- **Логирование и отладка:**
  ```bash
  journalctl -u custom-exporter.service -f
  ```
  "Для отслеживания логов я использовал `journalctl`."

---

### **4. Кому вы устанавливали Custom Exporter?**
**Пример ответа:**
"Я устанавливал Custom Exporter на:
- **Серверы приложений:** для сбора специфических метрик (например, количество активных пользователей).
- **Базы данных:** для мониторинга кастомных метрик (например, количество запросов к определённой таблице).
- **Контейнеры:** для сбора метрик внутри Docker или Kubernetes."

---

### **5. Пример успешного кейса использования Custom Exporter**
**Пример ответа:**
"Однажды нам нужно было мониторить количество ошибок в логах одного из наших сервисов. Мы написали Custom Exporter на Python, который:
1. Читал логи из файла или системы логирования (например, через syslog).
2. Подсчитывал количество ошибок за определённый период.
3. Экспортировал эти данные в формате Prometheus.

Мы интегрировали этот экспортер с Prometheus и настроили алерты в Alertmanager. Когда количество ошибок превышало пороговое значение, команда получала уведомление в Telegram. Это позволило нам оперативно реагировать на проблемы."

---

### **6. Какие каверзные вопросы могут возникнуть и как на них ответить?**

#### **Вопрос: Почему нельзя было использовать стандартные экспортеры?**
**Ответ:**
"Стандартные экспортеры, такие как Node Exporter или Blackbox Exporter, покрывают только общие метрики. В нашем случае требовались специфические метрики, которые не собирались автоматически. Например, количество заказов в системе или частота определённых событий в логах."

#### **Вопрос: Как вы решали проблемы с производительностью Custom Exporter?**
**Ответ:**
"Если возникали проблемы с производительностью, я:
- Оптимизировал код (например, уменьшал количество операций ввода-вывода).
- Использовал кэширование для временных данных.
- Запускал экспортер на более мощном сервере или в контейнере с выделенными ресурсами."

#### **Вопрос: Как вы обеспечивали отказоустойчивость Custom Exporter?**
**Ответ:**
"Для отказоустойчивости я:
- Размещал экспортер на нескольких серверах.
- Настроил автозапуск через systemd.
- Добавлял мониторинг самого экспортера через метрики Prometheus (например, `up` для проверки доступности)."

#### **Вопрос: Как вы тестировали Custom Exporter?**
**Ответ:**
"Я тестировал экспортер следующими способами:
- Проверял корректность формата метрик через `/metrics`.
- Нагружал его тестовыми данными для проверки производительности.
- Проверял интеграцию с Prometheus и Grafana."

---

### **7. Что ещё можно добавить?**
- **Интеграция с Prometheus и Grafana:**  
  "Мы интегрировали Custom Exporter с Prometheus для сбора метрик и с Grafana для визуализации. Это позволило нам создавать информативные дашборды."

- **Автоматизация установки:**  
  "Для масштабирования я написал Ansible playbook для автоматической установки и настройки Custom Exporter."

- **Мониторинг бизнес-метрик:**  
  "Мы использовали Custom Exporter для мониторинга ключевых бизнес-метрик, таких как количество активных пользователей или среднее время обработки запроса."
